[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I decided to give this a go as a learning exercise. I’ve been teaching with tmap for a few years. Version 4.0 is in the offing and introduces some major changes, which at first glance make it trickier to teach, and closer in many ways to ggplot2, which I have often considered instead. So… I thought I’d try to make a bunch of maps using both platforms to get a feel for the pros and cons of each."
  },
  {
    "objectID": "maps/04-bad-map.html",
    "href": "maps/04-bad-map.html",
    "title": "04 Bad Map",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/04-bad-map.html#data-wrangling",
    "href": "maps/04-bad-map.html#data-wrangling",
    "title": "04 Bad Map",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nsh1 <- st_read(\"data/sh1.gpkg\") %>%\n  st_transform(4326) %>%\n  select(geom) %>%\n  mutate(Mode = \"Road\")\ninterislander <- st_read(\"data/interislander.gpkg\") %>%\n  st_transform(4326) %>%\n  select(geom) %>%\n  mutate(Mode = \"Boat\")\ncombined <- sh1 %>%\n  bind_rows(interislander) %>%\n  mutate(Mode = as.factor(Mode))"
  },
  {
    "objectID": "maps/04-bad-map.html#tmap",
    "href": "maps/04-bad-map.html#tmap",
    "title": "04 Bad Map",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(combined) +\n  tm_lines(\n    col = \"Mode\",\n    col.scale = tm_scale_categorical(\n      values = c(\"red\", \"blue\"),\n      levels = c(\"Road\", \"Boat\")),\n    lty = \"Mode\",\n    lty.scale = tm_scale_categorical(\n      values = c(\"solid\", \"dashed\"),\n      levels = c(\"Road\", \"Boat\")),\n    lty.legend = tm_legend_combine(\"col\"),\n    lwd = 0.5) +\n  tm_layout(\n    frame = FALSE,\n    legend.frame = FALSE,\n    legend.outside = TRUE) +\n  tm_compass()"
  },
  {
    "objectID": "maps/04-bad-map.html#ggplot2",
    "href": "maps/04-bad-map.html#ggplot2",
    "title": "04 Bad Map",
    "section": "ggplot2",
    "text": "ggplot2\nHere we need an additional package. ggspatial can do it and seems preferable to the not-very-configurable ggsn. The configurability of ggspatial seems a bit over the top for a simple map like this. On the other hand its default north arrow is very on brand for the themes “Bad Map”!\n\nlibrary(ggspatial)\n\nggplot(combined) +\n  geom_sf(aes(colour = Mode, linetype = Mode), linewidth = 0.2) +\n  scale_colour_manual(values = c(\"blue\", \"red\")) +\n  scale_linetype_manual(values = c(\"dotted\", \"solid\")) +\n  annotation_north_arrow(location = \"br\") + \n  theme_void()"
  },
  {
    "objectID": "maps/02-lines.html",
    "href": "maps/02-lines.html",
    "title": "02 Lines",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/02-lines.html#data-wrangling",
    "href": "maps/02-lines.html#data-wrangling",
    "title": "02 Lines",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nnz <- st_read(\"data/nz.gpkg\") %>%\n  st_cast(\"MULTILINESTRING\") %>%\n  mutate(What = \"Shore\",\n         What = as.factor(What))"
  },
  {
    "objectID": "maps/02-lines.html#tmap",
    "href": "maps/02-lines.html#tmap",
    "title": "02 Lines",
    "section": "tmap",
    "text": "tmap\nSome of this code is a workaround for an issue I reported.\n\ntm_shape(nz, bbox = nz %>% st_union() %>% st_buffer(500)) + \n  tm_lines(\n    col = \"blue\",\n    lwd = 0.5) + \n  tm_add_legend(\n    type = \"lines\",\n    col = c(\"blue\"),\n    labels = c(\"Shore\"),\n    title = \"What\") +\n  tm_layout(\n    frame = FALSE,\n    legend.frame = FALSE,\n    legend.outside = TRUE)"
  },
  {
    "objectID": "maps/02-lines.html#ggplot2",
    "href": "maps/02-lines.html#ggplot2",
    "title": "02 Lines",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(nz) +\n  geom_sf(aes(colour = What), linewidth = 0.25) +\n  scale_colour_manual(values = c(\"blue\")) +\n  theme_void()"
  },
  {
    "objectID": "maps/01-points.html",
    "href": "maps/01-points.html",
    "title": "01 Points",
    "section": "",
    "text": "The first three themes (points, lines, areas) all work with the same data. I’m making a meta-point about the somewhat arbitrary nature of geometries in spatial data (a polygon is after all conceputalised as a point set)."
  },
  {
    "objectID": "maps/01-points.html#libraries",
    "href": "maps/01-points.html#libraries",
    "title": "01 Points",
    "section": "Libraries",
    "text": "Libraries\n\n\nCode\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/01-points.html#data-wrangling",
    "href": "maps/01-points.html#data-wrangling",
    "title": "01 Points",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nw <- 500\n\nnz <- st_read(\"data/nz.gpkg\") %>%\n  mutate(Land = TRUE)\n\nbb <- nz %>% \n  st_bbox() %>%\n  st_as_sfc() %>%\n  st_as_sf(crs = st_crs(nz)) %>%\n  st_buffer(w, nQuadSegs = 1) \n\nshore <- nz %>% \n  st_cast(\"MULTILINESTRING\") %>%\n  st_cast(\"LINESTRING\") %>%\n  st_buffer(w) %>%\n  st_as_sfc() %>%\n  st_as_sf(crs = st_crs(nz)) %>%\n  mutate(Shore = TRUE)\n\nland <- nz %>%\n  st_union() %>%\n  st_buffer(w)\n\nwater <- bb %>%\n  st_difference(land) %>%\n  mutate(Water = TRUE)\n\npts <- bb %>%\n  st_sample(250000) %>%\n  st_sf() %>%\n  st_as_sf(crs = st_crs(nz)) %>%\n  st_join(water) %>%\n  st_join(nz) %>%\n  st_join(shore) %>%\n  mutate(Water = replace_na(Water, FALSE),\n         Land  = replace_na(Land, FALSE),\n         Shore = replace_na(Shore, FALSE),\n         What = NA) %>%\n  slice(sample(1:n()))\n\npts[pts$Water, \"What\"] <- \"Water\"\npts[pts$Land, \"What\"] <- \"Land\"\npts[pts$Shore, \"What\"] <- \"Shore\"\n\npts <- pts %>%\n  mutate(What = as.factor(What)) %>%\n  filter(!is.na(What))"
  },
  {
    "objectID": "maps/01-points.html#tmap",
    "href": "maps/01-points.html#tmap",
    "title": "01 Points",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(pts) + \n  tm_bubbles(\n    fill = \"What\",\n    fill.scale = tm_scale_categorical(\n      values = c(\"#33aa6660\", \"#0000ff60\", \"#bbddff60\"),\n      levels = c(\"Land\", \"Shore\", \"Water\")), \n    size = 0.2,\n    lwd = 0) +\n  tm_layout(\n    frame = FALSE,\n    legend.frame = FALSE,\n    legend.outside = TRUE)"
  },
  {
    "objectID": "maps/01-points.html#ggplot2",
    "href": "maps/01-points.html#ggplot2",
    "title": "01 Points",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(pts) +\n  geom_sf(aes(colour = What), size = 0.2) +\n  scale_colour_manual(values = c(\"#33aa6660\", \"#0000ff60\", \"#bbddff60\")) + \n  theme_void()"
  },
  {
    "objectID": "maps/16-europe.html",
    "href": "maps/16-europe.html",
    "title": "16 Europe",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/16-europe.html#data-wrangling",
    "href": "maps/16-europe.html#data-wrangling",
    "title": "16 Europe",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Europe\"\nlon0 <- 30\nlat0 <- 60\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/16-europe.html#tmap",
    "href": "maps/16-europe.html#tmap",
    "title": "16 Europe",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/16-europe.html#ggplot2",
    "href": "maps/16-europe.html#ggplot2",
    "title": "16 Europe",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/10-north-america.html",
    "href": "maps/10-north-america.html",
    "title": "10 North America",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/10-north-america.html#data-wrangling",
    "href": "maps/10-north-america.html#data-wrangling",
    "title": "10 North America",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"North America\"\nlon0 <- -105\nlat0 <- 45\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/10-north-america.html#tmap",
    "href": "maps/10-north-america.html#tmap",
    "title": "10 North America",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/10-north-america.html#ggplot2",
    "href": "maps/10-north-america.html#ggplot2",
    "title": "10 North America",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/12-south-america.html",
    "href": "maps/12-south-america.html",
    "title": "12 South America",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/12-south-america.html#data-wrangling",
    "href": "maps/12-south-america.html#data-wrangling",
    "title": "12 South America",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"South America\"\nlon0 <- -62\nlat0 <- -21\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/12-south-america.html#tmap",
    "href": "maps/12-south-america.html#tmap",
    "title": "12 South America",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/12-south-america.html#ggplot2",
    "href": "maps/12-south-america.html#ggplot2",
    "title": "12 South America",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/index.html",
    "href": "maps/index.html",
    "title": "30 Day Map Challenge 2023",
    "section": "",
    "text": "I decided to give this a go as a learning exercise. I’ve been teaching with tmap for a few years. Version 4.0 is in the offing and introduces some major changes, which at first glance make it trickier to teach, and closer in many ways to ggplot2, which I have often considered instead. So… I thought I’d try to make a bunch of maps using both platforms to get a feel for the pros and cons of each.\n\n\n\n\n\n\n\n\n\n\n\n01 Points\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n02 Lines\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n03 Polygons\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n04 Bad Map\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n06 Asia\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n07 Navigation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n08 Africa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n09 Hexes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n10 North America\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n12 South America\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n14 Oceania\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n16 Europe\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n22 North is Not Up\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n25 Antarctica\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "maps/09-hexes.html",
    "href": "maps/09-hexes.html",
    "title": "09 Hexes",
    "section": "",
    "text": "Wishing to use a static web basemap increased the degree of difficulty here.\nHaving said that, tmap’s built in tm_basemap() function seems promising and intuitive.\nA bit of hunting around suggests that the ggspatial package’s annotation_map_tile() function is the best for basemaps in ggplot2."
  },
  {
    "objectID": "maps/09-hexes.html#libraries",
    "href": "maps/09-hexes.html#libraries",
    "title": "09 Hexes",
    "section": "Libraries",
    "text": "Libraries\n\n\nCode\nlibrary(dplyr)\nlibrary(h3forr)\nlibrary(tmap)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(stringr)"
  },
  {
    "objectID": "maps/09-hexes.html#data-wrangling",
    "href": "maps/09-hexes.html#data-wrangling",
    "title": "09 Hexes",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nsquare <- c(1.74e6 + 1e4 * c(0, 0, 1, 1, 0), \n            5.42e6 + 1e4 * c(0, 1, 1, 0, 0)) %>%\n  matrix(ncol = 2) %>%\n  list() %>%\n  st_polygon() %>%\n  st_sfc() %>%\n  st_sf(crs = 2193) %>%\n  st_transform(4326)\n\nget_hexes <- function(poly, resolution, distance) {\n  poly %>% \n    st_buffer(distance) %>%\n    polyfill(res = resolution) %>% \n    h3_to_geo_boundary() %>% \n    geo_boundary_to_sf()\n}\n\nh3_5 <- get_hexes(square, 5, 5000) %>% \n  st_cast(\"LINESTRING\")\nh3_6 <- get_hexes(square, 6, 2500) %>% \n  st_cast(\"LINESTRING\")\nh3_7 <- get_hexes(square, 7, 1500) %>% \n  st_cast(\"LINESTRING\")\nh3_8 <- get_hexes(square, 8, 1000) %>% \n  st_cast(\"LINESTRING\")\nh3_9 <- get_hexes(square, 9, 750) %>% \n  st_cast(\"LINESTRING\")\nh3_10 <- get_hexes(square, 10, 500) %>% \n  st_cast(\"LINESTRING\")\n\nbb <- h3_10 %>% \n  st_union() %>%\n  st_bbox()\n\ncredit <- maptiles::get_credit(\"OpenStreetMap\")"
  },
  {
    "objectID": "maps/09-hexes.html#tmap",
    "href": "maps/09-hexes.html#tmap",
    "title": "09 Hexes",
    "section": "tmap",
    "text": "tmap\ntmap v4 has a built-in web basemap function. The raster downscaling kicks in to make the image a bit unsatisfactory, but I assume that option will be tweakable in due course.\n\ntm_basemap(server = \"OpenStreetMap\", zoom = 12) +\n  tm_shape(h3_5) + \n  tm_lines(lwd = 3.5) +\n  tm_shape(h3_6) + \n  tm_lines(lwd = 2.5) +\n  tm_shape(h3_7) + \n  tm_lines(lwd = 1.5) +\n  tm_shape(h3_8) + \n  tm_lines(lwd = 1) +\n  tm_shape(h3_9) + \n  tm_lines(lwd = 0.7) +\n  tm_shape(h3_10, is.main = TRUE) + \n  tm_lines(lwd = 0.5) +\n  tm_credits(\n    credit,\n    position = tm_pos_out(pos.h = \"RIGHT\", pos.v = \"TOP\",\n                          cell.h = \"center\", cell.v = \"bottom\")) + \n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/09-hexes.html#ggplot2",
    "href": "maps/09-hexes.html#ggplot2",
    "title": "09 Hexes",
    "section": "ggplot2",
    "text": "ggplot2\nggspatial seems the best option for a static background basemap.\n\nlibrary(ggspatial)\n\nggplot(square, aes(colour = \"#00000000\")) +\n  annotation_map_tile(zoomin = 1) + \n  geom_sf(data = h3_5, linewidth = 1, colour = \"black\") +\n  geom_sf(data = h3_6, linewidth = 0.75, colour = \"black\") +\n  geom_sf(data = h3_7, linewidth = 0.6, colour = \"black\") +\n  geom_sf(data = h3_8, linewidth = 0.45, colour = \"black\") +\n  geom_sf(data = h3_9, linewidth = 0.35, colour = \"black\") +\n  geom_sf(data = h3_10, linewidth = 0.25, colour = \"black\") +\n  xlim(bb[1], bb[3]) +\n  ylim(bb[2], bb[4]) +\n  theme_void()"
  },
  {
    "objectID": "maps/06-asia.html",
    "href": "maps/06-asia.html",
    "title": "06 Asia",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/06-asia.html#data-wrangling",
    "href": "maps/06-asia.html#data-wrangling",
    "title": "06 Asia",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Asia\"\nlon0 <- 100\nlat0 <- 45\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/06-asia.html#tmap",
    "href": "maps/06-asia.html#tmap",
    "title": "06 Asia",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/06-asia.html#ggplot2",
    "href": "maps/06-asia.html#ggplot2",
    "title": "06 Asia",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/08-africa.html",
    "href": "maps/08-africa.html",
    "title": "08 Africa",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/08-africa.html#data-wrangling",
    "href": "maps/08-africa.html#data-wrangling",
    "title": "08 Africa",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Africa\"\nlon0 <- 20\nlat0 <- 0\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/08-africa.html#tmap",
    "href": "maps/08-africa.html#tmap",
    "title": "08 Africa",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/08-africa.html#ggplot2",
    "href": "maps/08-africa.html#ggplot2",
    "title": "08 Africa",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/25-antarctica.html",
    "href": "maps/25-antarctica.html",
    "title": "25 Antarctica",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/25-antarctica.html#data-wrangling",
    "href": "maps/25-antarctica.html#data-wrangling",
    "title": "25 Antarctica",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Antarctica\"\nlon0 <- 0\nlat0 <- -90\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/25-antarctica.html#tmap",
    "href": "maps/25-antarctica.html#tmap",
    "title": "25 Antarctica",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/25-antarctica.html#ggplot2",
    "href": "maps/25-antarctica.html#ggplot2",
    "title": "25 Antarctica",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/07-navigation.html",
    "href": "maps/07-navigation.html",
    "title": "07 Navigation",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(geosphere)\nlibrary(ggplot2)\nlibrary(stringr)\n\nsource(\"~/Documents/code/30-day-maps-2023/maps/utils.R\")"
  },
  {
    "objectID": "maps/07-navigation.html#data-wrangling",
    "href": "maps/07-navigation.html#data-wrangling",
    "title": "07 Navigation",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nstart_lat <- -41.3\nstart_lon <- 174.75\nend_lat <- 45\northo_proj <- str_glue(\"+proj=ortho +lat_0={start_lat} +lon_0={174.75}\")\nbearing <- -88.5\nstep_length <- 5e4\nlast_pt <- c(start_lon, start_lat)\nlox <- list()\ntransect <- last_pt\ni <- 1\nwhile (last_pt[2] < end_lat) {\n  next_pt <- destPointRhumb(last_pt, bearing, step_length)\n  if (next_pt[1] > last_pt[1]) {\n    lox[[i]] <- transect\n    i <- i + 1\n    transect <- c(next_pt)\n  } else {\n    transect <- c(transect, next_pt)\n  }\n  last_pt <- next_pt\n}\nlox[[i]] <- transect\n\nlox_sf <- lox %>%\n  lapply(unlist) %>%\n  lapply(matrix, ncol = 2, byrow = TRUE) %>%\n  st_multilinestring() %>%\n  st_sfc() %>%\n  st_sf(crs = 4326) %>%\n  st_cast(\"LINESTRING\") %>%\n  st_cast(\"POINT\")\n\ndata(\"World\")\nworld <- World %>%\n  st_cast(\"POLYGON\") %>%\n  st_transform(ortho_proj) %>%\n  dplyr::filter(!(st_is_empty(geometry)))\n\ngraticule <- get_graticule(centre = c(start_lon, start_lat)) %>%\n  st_transform(ortho_proj)"
  },
  {
    "objectID": "maps/07-navigation.html#tmap",
    "href": "maps/07-navigation.html#tmap",
    "title": "07 Navigation",
    "section": "tmap",
    "text": "tmap\nAt time of writing there is a bug in tm_title so no title on this map. See this issue.\nNote that I hand made the graticule using code from a sourced R file which trims the graticule to only extend across the mapped area. Neither tmap nor ggplot2 successfully applied the graticule in this projection without errors using their native functionality.\n\ntm_shape(world) +\n  tm_fill(fill = \"#cccccc\", lwd = 0) +\n  tm_shape(graticule, is.main = TRUE) +\n  tm_lines(col = \"grey\", lwd = 0.5) +\n  tm_shape(lox_sf) +\n  tm_dots(fill = \"firebrick\", size = 0.001) +\n  # tm_title(\"    Go (just north of) west! See also Day 22\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/07-navigation.html#ggplot2",
    "href": "maps/07-navigation.html#ggplot2",
    "title": "07 Navigation",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world) +\n  geom_sf(fill = \"#cccccc\", linewidth = 0) +\n  geom_sf(data = graticule, colour = \"grey\", linewidth = 0.2) +\n  geom_sf(data = lox_sf, colour = \"firebrick\", size = 0.01) +\n  ggtitle(\"Go (just north of) west! See also Day 22\") +\n  theme_void()"
  },
  {
    "objectID": "maps/22-north-not-up.html",
    "href": "maps/22-north-not-up.html",
    "title": "22 North is Not Up",
    "section": "",
    "text": "See also Antarctica."
  },
  {
    "objectID": "maps/22-north-not-up.html#libraries",
    "href": "maps/22-north-not-up.html#libraries",
    "title": "22 North is Not Up",
    "section": "Libraries",
    "text": "Libraries\n\n\nCode\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)\n\nsource(\"~/Documents/code/30-day-maps-2023/maps/utils.R\")"
  },
  {
    "objectID": "maps/22-north-not-up.html#data-wrangling",
    "href": "maps/22-north-not-up.html#data-wrangling",
    "title": "22 North is Not Up",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Antarctica\"\nlon0 <- 0\nlat0 <- -90\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT) %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)\n\ngraticule <- get_graticule(spacing = 15)"
  },
  {
    "objectID": "maps/22-north-not-up.html#tmap",
    "href": "maps/22-north-not-up.html#tmap",
    "title": "22 North is Not Up",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world) +\n  tm_fill() + \n  tm_shape(graticule) +\n  tm_lines(col = \"lightgrey\", lwd = 0.5) +\n  tm_compass() +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/22-north-not-up.html#ggplot2",
    "href": "maps/22-north-not-up.html#ggplot2",
    "title": "22 North is Not Up",
    "section": "ggplot2",
    "text": "ggplot2\nWe need ggspatial for a north arrow here.\n\nlibrary(ggspatial)\n\nggplot(world) +\n  geom_sf(linewidth = 0) +\n  geom_sf(data = graticule, col = \"lightgrey\", linewidth = 0.25) +\n  annotation_north_arrow(location = \"br\") + \n  theme_void()"
  },
  {
    "objectID": "maps/14-oceania.html",
    "href": "maps/14-oceania.html",
    "title": "14 Oceania",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/14-oceania.html#data-wrangling",
    "href": "maps/14-oceania.html#data-wrangling",
    "title": "14 Oceania",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nfocus <- \"Oceania\"\nlon0 <- 170\nlat0 <- -10\nproj <- str_glue(\"+proj=ortho lon_0={lon0} lat_0={lat0}\")\n\n\n\n\nCode\nworld <- st_read(\"data/world.gpkg\") %>%\n  st_make_valid() %>%\n  select(CONTINENT)\n\nworld_o <- world %>%\n  st_transform(proj) %>%\n  st_make_valid() %>%\n  filter(!st_is_empty(.)) %>%\n  group_by(CONTINENT) %>%\n  summarise() \n\ncontinent <- world %>%\n  filter(CONTINENT == focus)"
  },
  {
    "objectID": "maps/14-oceania.html#tmap",
    "href": "maps/14-oceania.html#tmap",
    "title": "14 Oceania",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(world_o) +\n  tm_fill() + \n  tm_shape(continent) +\n  tm_fill(fill = \"red\") +\n  tm_layout(frame = FALSE)"
  },
  {
    "objectID": "maps/14-oceania.html#ggplot2",
    "href": "maps/14-oceania.html#ggplot2",
    "title": "14 Oceania",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(world_o) +\n  geom_sf(linewidth = 0) +\n  geom_sf(\n    data = continent, \n    fill = \"red\", \n    linewidth = 0) +\n  theme_void()"
  },
  {
    "objectID": "maps/03-polygons.html",
    "href": "maps/03-polygons.html",
    "title": "03 Polygons",
    "section": "",
    "text": "Code\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "maps/03-polygons.html#data-wrangling",
    "href": "maps/03-polygons.html#data-wrangling",
    "title": "03 Polygons",
    "section": "Data wrangling",
    "text": "Data wrangling\n\n\nCode\nnz <- st_read(\"data/nz.gpkg\") %>%\n  st_union() %>%\n  st_as_sf() %>%\n  mutate(What = \"Land\")\n\nnot_nz <- nz %>% \n  st_union() %>%\n  st_buffer(500) %>%\n  st_bbox() %>%\n  st_as_sfc() %>%\n  st_as_sf() %>%\n  st_difference(nz) %>%\n  mutate(What = \"Water\")\n\nnz_not_nz <- nz %>%\n  bind_rows(not_nz) %>%\n  mutate(What = as.factor(What))"
  },
  {
    "objectID": "maps/03-polygons.html#tmap",
    "href": "maps/03-polygons.html#tmap",
    "title": "03 Polygons",
    "section": "tmap",
    "text": "tmap\n\ntm_shape(nz_not_nz) + \n  tm_fill(\n    fill = \"What\", \n    fill.scale = tm_scale_categorical(\n      values = c(\"#33aa66\", \"#bbddff\"),\n      levels = c(\"Land\", \"Water\"))) +\n  tm_layout(\n    frame = FALSE,\n    legend.frame = FALSE,\n    legend.outside = TRUE)"
  },
  {
    "objectID": "maps/03-polygons.html#ggplot2",
    "href": "maps/03-polygons.html#ggplot2",
    "title": "03 Polygons",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot(nz_not_nz) +\n  geom_sf(aes(fill = What), linewidth = 0) +\n  scale_fill_manual(values = c(\"#33aa66\", \"#bbddff\")) +\n  theme_void()"
  }
]